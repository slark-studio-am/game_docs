# 1.0 游戏设定

- ### 1.1 目录

  - [<div>1.2 游戏会出现的属性</div>](#shuxing)
  - [<div>1.3 属性加成方式</div>](#shuxingjiacheng)
  - [<div>1.4 伤害类型</div>](#shanghaileixing)
  - [<div>1.5 攻击目标</div>](#gongjimubiao)
  - [<div>1.6 物攻伤害链条</div>](#wugongshanghailiantiao)
  - [<div>1.7 技能伤害链条</div>](#jinengshanghailiantiao)
  - [<div>1.8 真实伤害链条</div>](#zhenshishanghai)
  - [<div>1.9 卡牌分类</div>](#kapaifenlei)
  - [<div>1.10 战场效果规则</div>](#210)
  - [<div>1.11 随机种子</div>](#111)
  - [<div>1.12 单位格子类型</div>](#111)

- ### 1.2 游戏中会出现的属性<div id="shuxing">

| 属性（*号属性不会在界面上显示） |                             说明                             |
| :-----------------------------: | :----------------------------------------------------------: |
|             生命值              |                   当生命值为0时，单位死亡                    |
|            物伤减免             | 按百分比减免所受到的物理伤害，比如当物伤减免为30%时，100的物理伤害最终只会造成70点物伤。上限[-100%, 100%] |
|            法伤减免             |       按百分比减免所受到的魔法伤害。上限[-100%, 100%]        |
|              物攻               |                 一次普通攻击所造成的物理伤害                 |
|              法强               |         法强会倍化一个技能的魔法伤害、治疗效果、护盾         |
|             暴击率              |    指在一次普通攻击[非真实伤害]中发生暴击的概率。上限100%    |
|            暴击效果             | 单位的基础暴击效果固定为原物理伤害的150%，额外暴击效果在这个基础上相加。比如额外暴击效果为50%<br />则此次暴击伤害为 物理攻击×（150% + 50%） |
|             闪避率              | 只能闪避物理伤害。当闪避判定成功时，将此次伤害的最终伤害修改为0 |
|              攻速               |                  两次普通攻击之间的间隔时间                  |
|             法力值              |               当法力值积满时，自动释放一次技能               |
|            生命偷取             | 对敌人造成物理伤害时，会回复相当于伤害量一定比例的生命值。比如敌人受到的最终伤害为100，生命偷取为10%，则此次攻击可回复10点生命值 |
|              护盾               | 护盾相当于是额外的生命，收到伤害时优先扣除。 护盾的数值无上限 |
|            *攻击回蓝            |              每进行一次普通攻击，回复5点法力值               |
|            *承伤回蓝            | 每受到一次伤害，回复伤害值×0.05的法力值，数值向下取整。单次承伤回蓝上限50 |
|            普攻目标             |                              -                               |
|            技能目标             |                              -                               |

- ### 1.3 属性加成方式<div id="shuxingjiacheng">

|   属性   |                         加成方式                         |
| :------: | :------------------------------------------------------: |
|   生命   |        原始最大生命值 * 百分比加成 + 固定数值加成        |
| 物伤减免 | 原始物伤减免 + 百分比加成[<sup>1</sup>](#gudingbaifenbi) |
| 法伤减免 |                原始法伤减免 + 百分比加成                 |
|   物攻   |           原始物攻 * 百分比加成 + 固定数值加成           |
|   法强   |           原始法强 * 百分比加成 + 固定数值加成           |
|  暴击率  |                 原始暴击率 + 百分比加成                  |
| 暴击效果 |                原始暴击效果 + 百分比加成                 |
|   攻速   |              原始攻速 / （1 + 百分比加成）               |
| 生命偷取 |                原始生命偷取 + 百分比加成                 |
| 攻击回蓝 |               原始攻击回蓝 + 固定数值加成                |
| 承伤回蓝 |               原始承伤回蓝 + 固定数值加成                |

注：<div id="gudingbaifenbi">【1】某些属性原本即是百分比，后续加成也是百分比，计算时需要将两个百分比直接相加</div>



- ### 1.4 伤害类型<div id="shanghaileixing">

  - **物理伤害**：由普通攻击所造成的伤害，可以被闪避，可以暴击，可以被护盾所抵挡。
  - **魔法伤害**：通过技能所造成的伤害，无法被闪避，无法暴击，可以被护盾所抵挡。
    - 特殊情况：假设一个技能时对敌方造成100点魔法伤害，附带20点物理伤害，那么这100点伤害不可闪避，附加的20点物理伤害可以被闪避
  - **真实伤害**：无法被闪避，无法暴击，护盾无法抵挡

  

- ### 1.5 普攻目标/技能目标<div id="gongjimubiao">

#### （1）位置示意图

|     1列      |     2列      |     3列      |
| :----------: | :----------: | :----------: |
| **敌方左后** | **敌方中后** | **敌方右后** |
| **敌方左前** | **敌方中前** | **敌方右前** |
| **我方左前** | **我方中前** | **我方右前** |
| **我方左后** | **我方中后** | **我方右后** |

#### **（2）目标描述**

| 1- 战场方向 |
| :---------: |
|    敌方     |
|    友方     |
|    全场     |

|  2- 条件   |
| :--------: |
|    随机    |
|     无     |
| 生命值最低 |
| 生命值最高 |
| 稀有度最高 |
|  拥有护盾  |
|  物攻最高  |
|  攻速最快  |
|    前排    |
|    后排    |
|    整列    |
|   待补充   |

| 3 - 目标个数 |
| :----------: |
|  0~12的整数  |

#### **（3）目标个数规则描述**

##### （1）单体（在不描述条件的情况下适用）

|     属性     |            说明            |
| :----------: | :------------------------: |
|   优先目标   |   与发起者同列的前排单位   |
| 转移目标条件 |   上一个目标位置上无单位   |
|   次要目标   | 从左前到右后的顺序寻找单位 |
| 最大目标数量 |             1              |

##### （2）前排/后排（在不描述条件的情况下适用）

|     属性     |           说明           |
| :----------: | :----------------------: |
|   优先目标   |    所有前排/后排单位     |
| 转移目标条件 | 前排/后排3个位置都无单位 |
|   次要目标   |    所有后排/前排单位     |
| 最大目标数量 |            3             |

##### （4）整列（在不描述条件的情况下适用）

|     属性     |             说明             |
| :----------: | :--------------------------: |
|   优先目标   |      与发起者同列的单位      |
| 转移目标条件 |  同列目标的2个位置都无单位   |
|   次要目标   | 从1列到3列的顺序寻找整列单位 |
| 最大目标数量 |              2               |

##### （5）全体

|     属性     |   说明   |
| :----------: | :------: |
|   优先目标   | 所有单位 |
| 转移目标条件 |    -     |
|   次要目标   |    -     |
| 最大目标数量 |    6     |

##### （6）条件

|     属性     |                             说明                             |
| :----------: | :----------------------------------------------------------: |
|   优先目标   |                         符合筛选条件                         |
| 转移目标条件 |                  搜寻不到符合筛选条件的目标                  |
|   次要目标   |                         随机选择单位                         |
| 最大目标数量 | 按描述中的数量。当符合条件的目标不足时，仍然保持相同的目标数量，但目标转向随机单位<br />比如：攻击2个有护盾的单位，当场上只有1个带护盾的单位时，攻击这个单位，并随机攻击另一个单位 |

- ### 1.6 普通攻击-伤害链条<div id="wugongshanghailiantiao">

  - **前提：**
    - 物理伤害 = 原始物理伤害 * 额外物理伤害百分比加成 + 额外物理伤害固定数值加成
    - 暴击伤害 = 原始暴击伤害 + 额外暴击伤害加成
    - 暴击率 = 原始暴击率 + 额外暴击率加成
    - 闪避率 = 原始闪避率 + 额外闪避率加成
    
    - 物伤减免 = 原始物伤减免 + 额外物伤减免加成
    
  - **查询攻击发起者身上是否存在阻碍攻击的dot**
  
  - 【判定有】阻止此次攻击
  
    - 【判定无】执行下一条
  
  - **根据暴击率进行暴击判定**
  
  - 【判定成功】物理伤害 = 物理伤害 * ( 1 + 暴击效果 )，执行下一条
  
    - 【判定失败】物理伤害 = 物理伤害
  
  - **根据闪避率进行闪避判定**
    - 【判定成功】物理伤害 = 0
    - 【判定失败】物理伤害 = 物理伤害
    
  - **查询被攻击者身上是否存在护盾**
    - 【存在护盾】物理伤害 = 护盾值 - 物理伤害 >= 0 ? 0 : 物理伤害 - 护盾值，并扣除相应数值的护盾值。若物理伤害>0则执行下一条
    - 【不存在护盾】物理伤害 = 物理伤害，执行下一条
    
  - **根据物伤减免属性对物理伤害进行减免**
    
    - 物理伤害 = 物理伤害 * ( 1 - 物伤减免 )
    
  - **最终伤害 = 物理伤害**
  
- **如果普通攻击中带有非物理类型的伤害，则按对应的伤害类型进行伤害判定**
  
- **伤害链条公式：**
  
  伤害 = 闪避率 ? 0 : 
  
  { [ 物攻 × ( 1 + 额外物攻百分比加成 ) + 额外物攻固定数值加成 ] 
  
  × ( 1 + 暴击效果 ) - 护盾值 }
  
  ×  ( 1 - 物伤减免 )


- ### 1.7 技能攻击-伤害链条<div id="jinengshanghailiantiao">

  - **前提：**
    
    - 法强 = 原始法强 * 额外法强百分比加成 + 额外法强伤害固定数值加成
    - 魔法伤害 = 根据技能说明而定，说明中会使用到法强
    
  - **攻击发起者的能量值满值后才可进行下一条**

  - **查询被攻击者身上是否存在护盾**
    
    - 【存在护盾】魔法伤害 = 护盾值 - 物理伤害 >= 0 ? 0 : 魔法伤害 - 护盾值，并扣除相应数值的护盾值。若魔法伤害>0则执行下一条
    - 【不存在护盾】魔法伤害 = 魔法伤害，执行下一条
    
  - **根据法伤减免属性对魔法伤害进行减免**
    
    - 魔法伤害 = 魔法伤害 * ( 1 - 法伤减免 )
    
  - **最终伤害 = 魔法伤害**

  - **如果技能攻击中带有非魔法类型的伤害，则按对应的伤害类型进行伤害判定**

  - **伤害链条公式：**

    伤害 = 

    { [ 法强 × ( 1 + 额外法强百分比加成 ) + 额外法强固定数值加成 ] 

    × 技能法强倍数 - 护盾值 }

    ×  ( 1 - 魔抗减免 ) 

  

- ### 1.8 真实伤害-伤害链条<div id="zhenshishanghai">

  - 真实伤害不受任何加成，也不受任何阻挡，直接对目标单位的生命值进行削减
  
  - **伤害链条公式：**
  
    伤害 = 真实伤害数值
  
  

- ### 1.9 卡牌分类<div id="kapaifenlei">

  - #### 战斗类（战斗类的卡牌都可以通过点击卡面展开详情）

    - 怪物卡组：以单位为基类，描述战斗中怪物一方的卡组，其中稀有度为3的是boss
    - 随从卡组：以单位为基类，描述玩家可以获得的随从卡组
    - 装备卡组：以单位为基类，描述玩家可以获得的装备卡组，装备卡组不具有生命值
    - 英雄卡组（玩家）：以单位为基类，玩家在游戏中的本体，在进入地图前需配置完毕
    - 神器(遗物)卡组：独立的神器基类，在战场中根据效果自动上场，自动生效，无需玩家进行额外配置

  - #### 非战斗类

    - 事件卡




- ### 1.10 战场效果规则<div id="210">

##### （1）画面效果

|     动作     |                           画面效果                           |
| :----------: | :----------------------------------------------------------: |
|   普通攻击   | 单位卡牌朝敌人方向移动1/5个卡牌长边的长度后，再恢复原状，整个过程0.5s |
| 普通攻击受击 |                  卡面上出现被击中的动画图像                  |
| 发动主动技能 | 单位卡牌卡面在原地放大0.5倍后，卡面上出现施法的动画图像，再恢复原状，整个过程0.5s |
|   技能受击   |            卡面上根据技能的不同出现不同的动画图像            |
|   获得护盾   |                       暂定，欲修改卡面                       |
|   失去护盾   |                       暂定，欲修改卡面                       |
|   死亡特效   | 播放死亡动画0.5s后，变成两半的卡面一边向两边移动一边淡出，持续1s |
|  复活或召唤  |                   1s内从战场的空位淡入卡牌                   |

普攻攻击

![攻击](https://i.loli.net/2021/03/02/C7cHE6yBb2MDloS.gif)

发动主动技能

![1614652078077](https://i.loli.net/2021/03/02/wO4sQXaF6LGjmqx.gif)

死亡特效

![1614838789507](https://i.loli.net/2021/03/04/AuGDFZwz7adrMmK.gif)



##### （2）音效

|     动作     | 画面效果 |
| :----------: | :------: |
|   普通攻击   | 大众音效 |
| 普通攻击受击 | 大众音效 |
| 发动主动技能 | 大众音效 |
|   技能受击   | 大众音效 |

先都弄大众音效，后面看下工作量和素材，充裕的话，在每个技能特效上加字段再独立绑定技能音效

##### （3）浮动文字

初版定义，待实装之后根据效果再做位置调整

|     伤害     |                 文字效果                  |   起点   | 平移方向 | 出现到淡出时间 |
| :----------: | :---------------------------------------: | :------: | :------: | :------------: |
|   普通攻击   |               白色，勾黑边                | 卡牌中心 |   向上   |      0.5s      |
| 普通攻击暴击 | #d12929，勾黑边，文本末尾带感叹号，字号+2 | 卡牌中心 |   向上   |      0.5s      |
|   技能伤害   |          #1da3d6，勾黑边，字号+2          | 卡牌中心 |   向上   |      0.5s      |
|   生命回复   |      #7ce687，勾黑边，文本前端带加号      | 卡牌中心 |   向上   |      0.5s      |



### 1.11 随机种子类型<div id="111">

|  字段名  |     字段      |                             描述                             |
| :------: | :-----------: | :----------------------------------------------------------: |
|  总种子  |   root_seed   |                        其他种子的母版                        |
| 初始种子 |  first_seed   |                 用于初始英雄和初始单位的随机                 |
| 单位种子 |  object_seed  |            用于战斗过程中单位属性中有关概率的判定            |
| 技能种子 |  skill_seed   | 用于战斗过程中单位主动技能、被动技能、buff中有关概率判定的部分 |
| 地图种子 |   map_seed    |                  用于地图中随机抽取事件卡牌                  |
| 事件种子 |  event_seed   |               用于所有与事件有关的概率判定部分               |
| 神器种子 | artifact_seed |              神器在效果生效过程中有关判定的部分              |



### 1.12 单位格子类型<div id="112">

归纳描述不同场景下的格子的交互方式，无法区分交互效果是做在场景内部还是格子上，由程序自由定夺。

|       字段名       |      字段       |                          值说明                          |
| :----------------: | :-------------: | :------------------------------------------------------: |
|      点按格子      |    press_box    |                点按格子内的卡牌产生的效果                |
|      长按格子      |    hold_box     |                长按格子内的卡牌产生的效果                |
|   长按并拖动格子   |    move_box     |             长按并拖动格子内的卡牌产生的效果             |
|      选中效果      | selected_effect |             点按中的选中效果所呈现的界面样式             |
| 格子组中是否为单选 | selected_count  | 在一组格子中，点按中的选中效果所选择的格子数量是否为单选 |

##### （1）适用场景：战场、背包中的查看单位卡牌、首页查看图鉴

![image-20210318144749295](https://i.loli.net/2021/03/18/UhJndb3HLKAZVMO.png)

|      交互方式      |   效果描述   |
| :----------------: | :----------: |
|      点按格子      | 弹出卡牌详情 |
|      长按格子      | 弹出卡牌详情 |
|   长按并拖动格子   |    无效果    |
|      选中效果      |      无      |
| 格子组中的选中数量 |      无      |

##### （2）适用场景：初始英雄及单位、升级卡牌事件、高级人才市场事件

![image-20210318151523979](https://i.loli.net/2021/03/18/iyLEI27OnGovMCt.png)

|      交互方式      |             效果描述              |
| :----------------: | :-------------------------------: |
|      点按格子      |             选中效果              |
|      长按格子      |           弹出卡牌详情            |
|   长按并拖动格子   |              无效果               |
|      选中效果      |     默认或&&居中显示卡牌属性      |
| 格子组中的选中数量 | 根据所需要的场景选择true or false |

附注1：默认的选中效果为深色遮罩；居中显示卡牌属性，比如在高级人才事件中，需要读取卡牌属性中的稀有度来显示对应的卡牌价值。

附注2：挖宝事件虽然不属于单位格子的讨论范围，但选中效果与此处一致，只不过挖宝事件的格子读取的不是单位卡牌信息，而是事件属性里的内容

##### （3）适用场景：背包中的修改战场配置

![image-20210318152032613](https://i.loli.net/2021/03/18/LQ2eAWVCNDkl9M4.png)

|   战场区交互方式   |             战场区效果描述             |
| :----------------: | :------------------------------------: |
|      点按格子      | 非英雄单位询问是否放逐；英雄单位无效果 |
|      长按格子      |              弹出卡牌详情              |
|   长按并拖动格子   |                交换位置                |
|      选中效果      |                   无                   |
| 格子组中的选中数量 |                   无                   |

|   手牌区交互方式   |                        战场区效果描述                        |
| :----------------: | :----------------------------------------------------------: |
|      点按格子      | 战场区未满的情况下询问是否加入战场；战场区已满的情况下无效果 |
|      长按格子      |                         弹出卡牌详情                         |
|   长按并拖动格子   |                            无效果                            |
|      选中效果      |                              无                              |
| 格子组中的选中数量 |                              无                              |