# 2.2 事件

### 2.2.1 目录

- [<div>2.2.2 地图规则</div>](#222)
- [<div>2.2.3 初始选择</div>](#223)
- [<div>2.2.4 界面展示</div>](#224)
- [<div>2.2.5 打开背包</div>](#225)
- [<div>2.2.6 关卡配置</div>](#226)
- [<div>2.2.7 回合配置</div>](#227)
- [<div>2.2.8 战斗事件</div>](#228)
- [<div>2.2.9 事件卡参数</div>](#229)
- [<div>2.2.10 获取单位事件</div>](#2210)
- [<div>2.2.11 营地事件</div>](#2211)
- [<div>2.2.12 秘宝事件</div>](#2212)
- [<div>2.2.13 人物强化事件</div>](#2213)
- [<div>2.2.20 卡牌效果</div>](#xgc)
- [<div>2.2.21 强化效果池</div>](#221)

### 2.2.2 地图规则<div id="222">

##### 规则

（1）开场时，系统将从玩家已解锁的所有英雄中随机选取3个英雄，交由玩家3选1。随机分配给玩家3个N级随从或武器，从中选取一个作为初始随从。

（2）在地图上可以配置战场。战场一共有六个卡槽，当单位卡被放置到卡槽后，只能移动在战场内的位置。

（3）当六个槽位都放满单位后，无法再放入或直接更换新的单位，如需更换单位，需要先从战场上选择一个单位放逐，然后再从额外卡牌集合中挑选一个单位置入战场，被放逐的卡牌将从本局游戏中消失,获得放逐补偿，根据放逐的卡牌稀有度来执行相应等级的放逐补偿

（4）当一张地图上的事件卡被确定使用时，根据卡牌的事件能量点数将会有等量的能量点随机飞向其他事件卡，事件卡每被击中1点，其事件能量点便下降1点，当事件能量点为0时，该事件卡从地图上消失。空缺的部分不会有新的事件卡进行补充。

（5）人物等级每打完一关升1级，怪物等级普遍在N至N+2之间浮动，N为回合数。

（6）每关的第五回合为BOSS战，胜利后会随机获得一个SR及以上等级的神器

（7）根据初始选择页面选择的英雄，将对应的英雄头像、英雄生命值、英雄等级在地图页面上显示，并将初始选择页面中的随从或武器置入背包中，使其在打开背包时可以被查看。



### 2.2.3 初始选择<div id="223">

![image-20210406143248881](https://tva1.sinaimg.cn/large/008eGmZEly1gpa0gxahylj30cl0lzgn7.jpg)

（1）该页面在主页面点击开始游戏之后，进入地图界面之前

（2）英雄和随从的界面暂时没有绘制上去，先用旧版的代替

（3）默认选择第一个英雄和第一个单位，点击开始按键后跳转到地图界面

##### table_init_choice

|      字段名      |     字段      |             值说明             |      值示例       |
| :--------------: | :-----------: | :----------------------------: | :---------------: |
|   可选英雄数量   |  hero_count   |               -                |         4         |
|     英雄来源     | hero_group_id | 从给定的分组中随机挑选一定数量 | group_hero_unlock |
| 可选初始单位数量 |  unit_count   |               -                |         3         |
|     单位来源     | unit_group_id | 从给定的分组中随机挑选一定数量 |   group_unit_N    |



### 2.2.4 界面展示<div id="224">

![image-20210406143316327](https://tva1.sinaimg.cn/large/008eGmZEly1gpa0hcr4wyj30cl0lzt9p.jpg)

### 2.2.5 打开背包<div id="225">

![image-20210317171347980](https://i.loli.net/2021/03/17/LNtP4OdCrnpWfV2.png)

附注1：可以在战场标签上配置战场的站位和增删已有的单位。战场放逐的补偿。



### 2.2.6 关卡配置<div id="226">

|   字段名   |    字段     |           值说明           |                          值示例                           |
| :--------: | :---------: | :------------------------: | :-------------------------------------------------------: |
|  关卡编号  |  stage_id   |             -              |                         stage_01                          |
| 回合编号组 | round_group | 包含本关所有回合编号的数组 | [ round_101, round_102,  round_103, round_104, round_105] |

（1）第五个回合限定为boss关，战斗成功后切换到下一个关卡

（2）boss关无特殊配置，依照正常的回合配置即可



### 2.2.7 回合配置<div id="227">

|    字段名    |           字段           |                            值示例                            |
| :----------: | :----------------------: | :----------------------------------------------------------: |
|   回合编号   |         round_id         |                          round_101                           |
|     战斗     |      battle_MapCard      | {‘group_attendant_R’, ‘5’, '5', 'group_attendant_N', 'true', '2', 'group_artifact_N', 'group_attendant_R'} |
| 单位事件集合 |    unit_MapCard_group    | { "招募单位"，“3”，“2”， “battle_bg.png”，“battle_image.png”，“{ "group_attendant_N" }”} |
| 单位事件数量 |    unit_MapCard_count    |                              6                               |
| 强化事件集合 | strengthen_MapCard_group | { "英雄强化"，“8”，“4”， “battle_bg.png”，“battle_image.png”，“{ "4"，”3“，”[<div>强化效果池</div>](#221)“ }” } |
| 强化事件数量 | strengthen_MapCard_count |                              1                               |
| 营地事件集合 |   update_MapCard_group   | { "休憩营地"，“8”，“4”， “battle_bg.png”，“battle_image.png”，“{ "1"，“10”，“3” }”} |
| 营地事件数量 |   update_MapCard_count   |                              1                               |
| 特殊事件集合 |  special_MapCard_group   | { “{另一个事件}”，“{ "一个大秘宝"，“8”，“4”， “battle_bg.png”，“battle_image.png”，“{ “0.4”，“group_artifact_dig_1”，"0.4"，“group_artifact_dig_2”，“0.2” }” }“ } |
| 特殊事件数量 |  special_MapCard_count   |                              1                               |



### 2.2.8 战斗事件<div id="228">

|      字段名      |       字段        |                            值说明                            |        值示例         |
| :--------------: | :---------------: | :----------------------------------------------------------: | :-------------------: |
|     主怪来源     |   boss_group_id   |         从所给定的单位分组中随机选择1个单位作为主怪          |   group_attendant_R   |
| 其他怪物数最大值 | max_monster_count |                 除主怪外其他怪物的数量最大值                 |           5           |
| 其他怪物数最小值 | min_monster_count |                 除主怪外其他怪物的数量最小值                 |           5           |
|   其他怪物来源   | monster_group_id  |       从所给定的单位分组中随机选择N个单位作为其他怪物        |   group_attendant_N   |
|    是否有奖励    |     is_award      |                    战斗胜利后是否有战利品                    |         true          |
|   战利品-单位    |    award_unit     | 战斗胜利后的单位类型战利品，集合内有几个来源就代表有几个单位奖励 | {"group_attendant_R"} |
|   战利品-神器    |  award_artifact   | 战斗胜利后的神器类型战利品，集合内有几个来源就代表有几个神器奖励 | {"group_artifact_N"}  |
|       备注       |  战利品界面欠缺   |                                                              |                       |

![image-20210322183229464](https://i.loli.net/2021/03/22/rhbANKUMo5aB1uY.png)



### 2.2.9 事件卡参数<div id="229">

|      字段名      |     字段      |                     值说明                     |          值示例           |
| :--------------: | :-----------: | :--------------------------------------------: | :-----------------------: |
|     事件标题     | MapCard_title |                       -                        |         招募单位          |
| 事件能量点最大值 |   max_point   |             能量点随机范围的最大值             |             3             |
| 事件能量点最小值 |   min_point   |             能量点随机范围的最小值             |             2             |
|     卡面效果     |    card_se    | 事件卡被能量点击中后的额外效果，从效果池中随机 | [<div>效果池</div>](#xgc) |
|   卡牌背景图片   |  card_color   |        卡牌在界面中显示的背景图片或颜色        |       battle_bg.png       |
|     牌面立绘     |  card_image   |                   卡牌的立绘                   |     battle_image.png      |



### 2.2.10 获取单位事件-参数<div id="228">

|  参数名  |     参数      |               值说明                |      值示例       |
| :------: | :-----------: | :---------------------------------: | :---------------: |
| 单位来源 | unit_group_id | 从所给定的单位分组中随机选择1个单位 | group_attendant_N |

获取单位事件参数集合 



![](https://i.loli.net/2021/03/22/bSgikKPCNmdxtEw.png)

### 





### 2.2.11 营地事件<div id="2211">

|         字段名          |       字段       |                    值说明                     | 值示例 |
| :---------------------: | :--------------: | :-------------------------------------------: | :----: |
|       单次升级数        |   once_update    |            目标单位单次提升多少级             |   1    |
|      初始生命回复       | initial_recovery |              无加成下的生命恢复               |   10   |
| 每1能量点减少增生命回复 | appendl_recovery | 卡牌能量点每减少1点，可恢复生命值便增加相应值 |   3    |



![image-20210322152558611](https://i.loli.net/2021/03/22/doIGB9ykx7sSMTa.png)



### 2.2.12 秘宝事件<div id="2212">

|    字段名    |       字段        |       值说明       |        值示例        |
| :----------: | :---------------: | :----------------: | :------------------: |
| 普通神器概率 |  artifact_N_per   | 普通神器的出现概率 |         65%          |
| 普通神器来源 | artifact_N_group  |         -          | group_artifact_dig_1 |
| 稀有神器概率 |  artifact_R_per   | 稀有神器的出现概率 |         30%          |
| 稀有神器来源 | artifact_R_group  |         -          | group_artifact_dig_2 |
| 史诗神器概率 |  artifact_SR_per  | 史诗神器的出现概率 |          5%          |
| 史诗神器来源 | artifact_SR_group |         -          | group_artifact_dig_3 |

![image-20210413170919591](https://i.loli.net/2021/04/13/7ivBL8d5axby2ES.png)



### 2.2.13 人物强化事件<div id="2213">

|  字段名  |     字段     |                值说明                |            值示例             |
| :------: | :----------: | :----------------------------------: | :---------------------------: |
| 选择数量 | choice_count |         可选择的强化效果数量         |               4               |
| 效果等级 | effect_level |        强化效果数值的效果等级        |               3               |
| 效果来源 | effect_group | 根据数量从效果来源中不重复的随机抽取 | [<div>强化效果池</div>](#221) |



![image-20210319220840670](https://i.loli.net/2021/03/19/LMTdGhoQmaDsVNj.png)



### 2.2.20 卡面效果池<div id="xgc">

| 效果名 |                             效果                             | 随机概率 |
| :----: | :----------------------------------------------------------: | :------: |
|  常规  |             被能量点击中时，自身的能量点减少1点              |   40%    |
|  爆炸  |    被任意能量点击中后，事件立刻消失，并释放所有事件能量点    |   10%    |
|  坚韧  |                    事件能量点不会小于1点                     |   10%    |
|  连锁  |            每被击中1次，所有事件的现有能量点数减1            |   10%    |
|  聚合  |         被能量点击中时，自身的能量点不是减少而是增加         |   10%    |
|  共生  | 共生效果的事件被选中时，逸散的能量点优先攻击在场的其他共生事件 |   10%    |
|  加倍  |           被选中时逸散的能量点是此时能量点数的2倍            |   10%    |

- 事件在场景中是以3D模型的形式展现，初始状态都是灰蒙蒙的
- 当有一个事件被选中时，由灰蒙蒙的状态变为原色显示，看能不能做一个动画效果，选中的时候身上的灰色散开然后聚合到一起变成光点
- 光点稍微延迟个1s，然后四处逸散，打在其他的事件模型上，被击中的事件模型会随着能量点越来越少颜色越来越黯淡，为0时就爆掉
- 如果遇到有【爆炸】效果的事件，先结算完上一个事件的能量点逸散，然后爆炸的事件再逸散能量点，但实际上它在第一次被击中后就死了，不会再受到后续的能量点攻击。



### 2.2.21 强化效果池<div id="221">

##### 正面池

|               效果               | 效果标识 | 权重 | 效果数值上限 | 效果数值下限 |
| :------------------------------: | :------: | :--: | :----------: | :----------: |
|          增加生命值上限          |   HSM    |  1   |   等级×20    |   等级×10    |
|             增加法强             |   HFQ    |  1   |   等级×10    |    等级×5    |
|             增加物攻             |   HWG    |  1   |   等级×10    |    等级×5    |
|           增加暴击效果           |   HBX    |  1   |   等级x10%   |   等级x5%    |
|             增快攻速             |   HGS    |  1   |   等级x5%    |   等级x3%    |
|  增加所有单位和英雄的生命值上限  |   QSM    |  1   |   等级×10    |    等级×2    |
|     增加所有单位和英雄的法强     |   QFQ    |  1   |    等级×5    |    等级×1    |
|     增加所有单位和英雄的物攻     |   QWG    |  1   |    等级×5    |    等级×2    |
|   增加所有单位和英雄的暴击效果   |   QBX    |  1   |   等级x5%    |   等级x2%    |
|     增快所有单位和英雄的攻速     |   QGS    |  2   |   等级x2%    |   等级x1%    |
|    提高所有单位和英雄的暴击率    |   QBJ    |  2   |   等级x2%    |   等级x1%    |
|            提高暴击率            |   HBJ    |  2   |   等级x2%    |   等级x1%    |
|          减少法力值上限          |   HLT    |  3   |    等级x2    |    等级x1    |
| 普通攻击的攻击方式更改为敌方全体 |   HQT    |  3   |      -       |      -       |

##### 负面池

|              效果              | 效果标识 | 效果数值上限 | 效果数值下限 |
| :----------------------------: | :------: | :----------: | :----------: |
|         减少生命值上限         |   HSM    |   等级×15    |    等级×1    |
|            减少法强            |   HFQ    |   等级×10    |    等级×1    |
|            减少物攻            |   HWG    |   等级×10    |    等级×1    |
|          减少暴击效果          |   HBX    |   等级x10%   |   等级x1%    |
|            减缓攻速            |   HGS    |   等级x5%    |   等级x1%    |
| 减少所有单位和英雄的生命值上限 |   QSM    |   等级×10    |    等级×1    |
|    减少所有单位和英雄的法强    |   QFQ    |    等级×5    |    等级×1    |
|    减少所有单位和英雄的物攻    |   QWG    |    等级×5    |    等级×1    |
|  减少所有单位和英雄的暴击效果  |   QBX    |   等级x5%    |   等级x1%    |
|    减缓所有单位和英雄的攻速    |   QGS    |   等级x2%    |   等级x1%    |
|   减少所有单位和英雄的暴击率   |   QBJ    |   等级x2%    |   等级x1%    |
|           减少暴击率           |   HBJ    |   等级x2%    |   等级x1%    |
|         增加法力值上限         |   HLT    |    等级x2    |    等级x1    |

- 一个完整的强化效果由正面效果和负面效果组合而成。
- 根据权重随机正面池的效果，然后随机从负面池抽取一个作为搭配，抽取负面效果时需要先排除相同效果标识的负面效果。

