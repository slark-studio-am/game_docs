#      1.0 游戏设定

- ### 1.1 目录

  - [<div>1.2 游戏会出现的属性</div>](#12)
  - [<div>1.3 属性加成方式</div>](#shuxingjiacheng)
  - [<div>1.4 伤害类型</div>](#shanghaileixing)
  - [<div>1.5 攻击目标</div>](#gongjimubiao)
  - [<div>1.6 物攻伤害链条</div>](#wugongshanghailiantiao)
  - [<div>1.7 技能伤害链条</div>](#jinengshanghailiantiao)
  - [<div>1.8 真实伤害链条</div>](#zhenshishanghai)
  - [<div>1.9 卡牌分类</div>](#kapaifenlei)
  - [<div>1.10 随机种子</div>](#110)
  - [<div>1.11 游戏共识</div>](#111)
  - [<div>1.12 状态机</div>](#112)
  - [<div>1.13 属性极限值</div>](#113)
  - [<div>1.14 死亡规则</div>](#114)
  
- ### 1.2 游戏中会出现的属性<div id="12">

|   属性   |                             说明                             |
| :------: | :----------------------------------------------------------: |
|  生命值  |                   当生命值为0时，单位死亡                    |
| 物伤减免 | 按百分比减免所受到的物理伤害，比如当物伤减免为30%时，100的物理伤害最终只会造成70点物伤。上限[-100%, 100%] |
| 法伤减免 |       按百分比减免所受到的魔法伤害。上限[-100%, 100%]        |
|   物攻   |                 一次普通攻击所造成的物理伤害                 |
|   法强   |         法强会倍化一个技能的魔法伤害、治疗效果、护盾         |
|  暴击率  |    指在一次普通攻击[非真实伤害]中发生暴击的概率。上限100%    |
| 暴击效果 | 单位的基础暴击效果固定为原物理伤害的150%，额外暴击效果在这个基础上相加。比如额外暴击效果为50%<br />则此次暴击伤害为 物理攻击×（150% + 50%） |
|  闪避率  | 只能闪避物理伤害。当闪避判定成功时，将此次伤害的最终伤害修改为0 |
|   攻速   |                  两次普通攻击之间的间隔时间                  |
|  法力值  |               当法力值积满时，自动释放一次技能               |
| 生命偷取 | 对敌人造成物理伤害时，会回复相当于伤害量一定比例的生命值。比如敌人受到的最终伤害为100，生命偷取为10%，则此次攻击可回复10点生命值 |
|   护盾   | 护盾相当于是额外的生命，收到伤害时优先扣除。 护盾的数值无上限 |
| 攻击回蓝 |              每进行一次普通攻击，回复5点法力值               |
| 承伤回蓝 | 每受到一次伤害，回复伤害值×0.05的法力值，数值向下取整。单次承伤回蓝上限50 |
| 普攻目标 |                              -                               |
| 技能目标 |                              -                               |

- ### 1.3 属性加成方式<div id="shuxingjiacheng">

|   属性   |                         加成方式                         |
| :------: | :------------------------------------------------------: |
|   生命   |        原始最大生命值 * 百分比加成 + 固定数值加成        |
| 物伤减免 | 原始物伤减免 + 百分比加成[<sup>1</sup>](#gudingbaifenbi) |
| 法伤减免 |                原始法伤减免 + 百分比加成                 |
|   物攻   |           原始物攻 * 百分比加成 + 固定数值加成           |
|   法强   |           原始法强 * 百分比加成 + 固定数值加成           |
|  暴击率  |                 原始暴击率 + 百分比加成                  |
| 暴击效果 |                原始暴击效果 + 百分比加成                 |
|   攻速   |              原始攻速 / （1 + 百分比加成）               |
| 生命偷取 |                原始生命偷取 + 百分比加成                 |
| 攻击回蓝 |               原始攻击回蓝 + 固定数值加成                |
| 承伤回蓝 |               原始承伤回蓝 + 固定数值加成                |

注：<div id="gudingbaifenbi">【1】某些属性原本即是百分比，后续加成也是百分比，计算时需要将两个百分比直接相加</div>



- ### 1.4 伤害类型<div id="shanghaileixing">

  - **物理伤害**：由普通攻击所造成的伤害，可以被闪避，可以暴击，可以被护盾所抵挡。
  - **魔法伤害**：通过技能所造成的伤害，无法被闪避，无法暴击，可以被护盾所抵挡。
    - 特殊情况：假设一个技能时对敌方造成100点魔法伤害，附带20点物理伤害，那么这100点伤害不可闪避，附加的20点物理伤害可以被闪避
  - **真实伤害**：无法被闪避，无法暴击，护盾无法抵挡

  

- ### 1.5 普攻目标/技能目标<div id="gongjimubiao">

#### **（1）目标描述**

##### 1- 战场方向

| 1- 战场方向 |
| :---------: |
|    敌方     |
|    友方     |
|    全场     |

##### 2 - 目标类型

| 2 - 目标类型 |
| :----------: |
|     单位     |
|    召唤物    |
|     英雄     |
|     自己     |

##### 3 - 条件

|              3 - 条件              |
| :--------------------------------: |
|                随机                |
|                 无                 |
|              生命比例              |
|              攻击速度              |
|             最大生命值             |
| 其他（除了发起者之外，按随机选取） |

##### 4 - 排序

| 4 - 排序方式 |
| :----------: |
|     升序     |
|     降序     |

##### 5 - 目标个数

|                         5 - 目标个数                         |
| :----------------------------------------------------------: |
|                          1~12的整数                          |
| 依据上述条件和排序筛选出的目标单位，根据目标个数取前N位，若筛选出的个数小于目标个数，则按筛选出的个数为准 |



- ### 1.6 普通攻击-伤害链条<div id="wugongshanghailiantiao">

  - **前提：**
    - 物理伤害 = 原始物理伤害 * 额外物理伤害百分比加成 + 额外物理伤害固定数值加成
    - 暴击伤害 = 原始暴击伤害 + 额外暴击伤害加成
    - 暴击率 = 原始暴击率 + 额外暴击率加成
    - 闪避率 = 原始闪避率 + 额外闪避率加成
    
    - 物伤减免 = 原始物伤减免 + 额外物伤减免加成
  - 1. **查询被攻击者身上的受击类型**
  - 【“物理攻击”没被勾选】阻止此次攻击

    - 【“物理攻击”被勾选】执行下一条
  - 2. **根据暴击率进行暴击判定**
  - 【判定成功】物理伤害 = 物理伤害 * ( 1 + 暴击效果 )，执行下一条

    - 【判定失败】物理伤害 = 物理伤害
  - 3. **根据闪避率进行闪避判定**
    
    - 【判定成功】物理伤害 = 0
    - 【判定失败】物理伤害 = 物理伤害
  - 4. **查询被攻击者身上是否存在护盾**
    
    - 【存在护盾】物理伤害 = 护盾值 - 物理伤害 >= 0 ? 0 : 物理伤害 - 护盾值，并扣除相应数值的护盾值。若物理伤害>0则执行下一条
    - 【不存在护盾】物理伤害 = 物理伤害，执行下一条
  - 5. **根据物伤减免属性对物理伤害进行减免**
    
    - 物理伤害 = 物理伤害 * ( 1 - 物伤减免 )
  - **最终伤害 = 物理伤害**

- **如果普通攻击中带有非物理类型的伤害，则按对应的伤害类型进行伤害判定**
  
- **伤害链条公式：**
  
  伤害 = 闪避率 ? 0 : 
  
  { [ 物攻 × ( 1 + 额外物攻百分比加成 ) + 额外物攻固定数值加成 ] 
  
  × ( 1 + 暴击效果 ) - 护盾值 }
  
  ×  ( 1 - 物伤减免 )
  
  


- ### 1.7 技能攻击-伤害链条<div id="jinengshanghailiantiao">

  - **前提：**
    
    - 法强 = 原始法强 * 额外法强百分比加成 + 额外法强伤害固定数值加成
    - 魔法伤害 = 根据技能说明而定，说明中会使用到法强
  - **攻击发起者的能量值满值后才可进行下一条**

  - **查询被攻击者身上的受击类型**
  - 【“法术攻击”没被勾选】阻止此次攻击

    - 【“法术攻击”被勾选】执行下一条

  - **查询被攻击者身上是否存在护盾**
    
    - 【存在护盾】魔法伤害 = 护盾值 - 物理伤害 >= 0 ? 0 : 魔法伤害 - 护盾值，并扣除相应数值的护盾值。若魔法伤害>0则执行下一条
    - 【不存在护盾】魔法伤害 = 魔法伤害，执行下一条
    
  - **根据法伤减免属性对魔法伤害进行减免**
    
    - 魔法伤害 = 魔法伤害 * ( 1 - 法伤减免 )
    
  - **最终伤害 = 魔法伤害**

  - **如果技能攻击中带有非魔法类型的伤害，则按对应的伤害类型进行伤害判定**

  - **伤害链条公式：**

    伤害 = 

    { [ 法强 × ( 1 + 额外法强百分比加成 ) + 额外法强固定数值加成 ] 

    × 技能法强倍数 - 护盾值 }

    ×  ( 1 - 魔抗减免 ) 

  

- ### 1.8 真实伤害-伤害链条<div id="zhenshishanghai">

  - 真实伤害不受任何加成，也不受任何阻挡，直接对目标单位的生命值进行削减
  
  - **伤害链条公式：**
  
    伤害 = 真实伤害数值
  
  

- ### 1.9 卡牌分类<div id="kapaifenlei">

  - #### 战斗类（战斗类的卡牌都可以通过点击卡面展开详情）

    - 怪物卡组：以单位为基类，描述战斗中怪物一方的卡组
    - 英雄卡组：以单位为基类，玩家在游戏中最主要的卡组
    - 召唤物卡组：通过英雄衍生出来的召唤物，一般通过事件卡获得
    - 强化卡组：用于描述强化英雄的卡牌
    - 事件卡组：在战备状态下使用的卡牌
    - 神器(遗物)卡组：独立的神器基类，在战场中根据效果自动上场，自动生效，无需玩家进行额外配置
    
    


### 1.10 随机种子类型<div id="110">

|  字段名  |     字段      |                             描述                             |
| :------: | :-----------: | :----------------------------------------------------------: |
|  总种子  |   root_seed   |                        其他种子的母版                        |
| 卡牌种子 |   card_seed   |               用于卡牌打出时有关概率的判定依据               |
| 单位种子 |   unit_seed   |   用于战斗过程中单位属性中或普通攻击目标有关概率的判定依据   |
| 技能种子 |  skill_seed   | 用于战斗过程中单位主动技能、被动技能、buff、主动技能目标中有关概率的判定依据 |
| 神器种子 | artifact_seed |              神器在效果生效过程中有关判定的部分              |
|          |               |                                                              |
|          |               |                                                              |



### 1.11 游戏共识<div id="111">

（1）所有技能描述给予BUFF时没有写明具体多少层数的，一律视为按1层BUFF。

（2）int型的单位属性在计算过程中一律向下取整。float型单位属性在计算过程中一律向下保留两位小数。

（3）【像素字体-简体中文-英文】下载地址：https://github.com/slark-studio-am/game_docs/tree/master/other_files/%E5%AD%97%E4%BD%93%E6%96%87%E4%BB%B6/%E5%83%8F%E7%B4%A0

（4）【幼圆字体-简体中文-繁体中文-英文】 下载地址：https://github.com/slark-studio-am/game_docs/tree/master/other_files/%E5%AD%97%E4%BD%93%E6%96%87%E4%BB%B6/%E5%B9%BC%E5%9C%86

（5）战备阶段是战斗阶段的延伸，只不过战备阶段属于时间暂停状态，除非有特殊描述，否则战斗结束时将保留单位身上一切状态和属性，不论是正面还是负面的效果。

（6）获得最大生命值的加成时，不会获得对应数值的生命值

（7）所有单位、技能、神器、强化、buff描述中没有写明主语的，一律按描述效果绑定的这个目标自己来算，比如【(技能释放者)使用主动技能时，回复(技能释放者)5点生命值】，如果有特定目标，一定会详情阐明。



### 1.12 状态机<div id="112">

|     状态     | 攻速条 | 技能条 |                   说明                   |
| :----------: | :----: | :----: | :--------------------------------------: |
|     待机     |  可动  |  可动  |                    -                     |
|   普通攻击   | 不可动 |  可动  |  执行普通攻击的画面效果和对目标造成伤害  |
| 发动主动技能 | 不可动 |  可动  |  执行主动技能的画面效果和相应的技能效果  |
|     暂停     | 不可动 |  可动  | 无法蓄力，无法普通攻击，无法发动主动技能 |
|   其他状态   |   -    |   -    |    除了切换到的新状态外的其他几个状态    |

| 当前状态 |                           切换条件                           |    新状态    |
| :------: | :----------------------------------------------------------: | :----------: |
|   待机   |                      普通攻击进度条蓄满                      |   普通攻击   |
|   待机   |                          法力值蓄满                          | 发动主动技能 |
| 其他状态 | 受BUFF影响如<a title='当该buff存在时，无法进行任何行动'>冻结</a> |     暂停     |
| 其他状态 |         有其他单位处于【普通攻击】或【发动技能】状态         |     暂停     |
| 普通攻击 |              普攻动画结束（普通攻击进度条清零）              |     待机     |
| 发动技能 |                主动技能动画结束（法力值清零）                |     待机     |
|   暂停   |                    造成暂停的BUFF时间结束                    |     待机     |

- 当待机状态下同时有多个单位即将切换为【普通攻击】或【发动技能】状态时，使用【单位种子】对待切换的单位进行优先切换顺序的排序。



### 1.13 属性极限值<div id="113">

|      属性      | 极小值 |      极小值说明      |         极大值         |           极大值说明           |
| :------------: | :----: | :------------------: | :--------------------: | :----------------------------: |
|     护盾值     |   0    |          -           |           +∞           |               -                |
|   显示生命值   |   0    |          -           | 显示最大生命值的极大值 |    不可超过生命上限的极大值    |
| 显示物理攻击力 | 0 - 0  | 上下限的极小值都为0  |        +∞ - +∞         |      上下限的极小值都为+∞      |
|  显示物伤减免  | -100%  |         增伤         |         +100%          | 超过±100%的加成将被修正到±100% |
|  显示法伤减免  | -100%  |         增伤         |         +100%          | 超过±100%的加成将被修正到±100% |
|   显示暴击率   |   0%   |      不发生暴击      |          100%          |  超过100%的加成将被修正到100%  |
|  显示暴击效果  |   0%   | 暴击伤害与原伤害一致 |           +∞           |               -                |
|   显示闪避率   |   0%   |          -           |          100%          |  超过100%的加成将被修正到100%  |
|  显示攻击速度  |  0.01  |          -           |           +∞           |               -                |
|   显示法力值   |   0    |          -           |       法力值上限       |  超过上限的部分将被修正到100%  |
|  显示生命偷取  |   0    |          -           |          100%          |  超过上限的部分将被修正到100%  |
|  显示承伤回蓝  |   0    |          -           |           50           |    单次承伤回蓝最多只能50点    |



### 1.14 死亡规则<div id="114">

- 英雄单位死亡时，将从战场上被送入墓地，且保留全部强化属性并移除全部战斗BUFF。在本场战斗结束后，将继续存在于墓地中。

[![REXUNd.png](https://z3.ax1x.com/2021/06/21/REXUNd.png)](https://imgtu.com/i/REXUNd)

- 非英雄单位死亡时，将从战场上被送入墓地，且移除全部战斗BUFF。在本场战斗结束后，如果还存在墓地中，将从墓地中被移除游戏。
- 描述中带有**复活**的技能进行统一规则，即：

|        描述        |                             效果                             |
| :----------------: | :----------------------------------------------------------: |
|   单位本身的技能   | 显示生命值归零之后，不送入战场，原地立即获得15%的生命值并移除身上所有的战斗BUFF，<br />不视为重新召唤入场，不会触发【战吼】效果 |
| 通过其他单位的技能 | 从战场中返回战场，获得15%的生命值，不视为重新召唤入场，不会触发【战吼】效果 |

- 允许以下极端情况：圣骑士的衍生物死亡时会获得重新召唤的卡牌，如果可以在本场战斗结束前再次把衍生物从墓地拉回来，并且二次死亡，规则上是允许获得第二张重新召唤的卡牌的。复活类的效果尽量做到怪物或者遗物里，并且严格区分复活非英雄单位。

