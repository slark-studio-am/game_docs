### 2.2.8 战斗事件<div id="228">

|   字段名   |     字段      |         值说明         | 值示例                                                       |
| :--------: | :-----------: | :--------------------: | :----------------------------------------------------------- |
|  对战来源  | battle_source |     对战怪物的来源     | group_battle(<br />"强度系数", <br />"**list_monster**("map_seed", "1", "重复", "放回")",  <br />"**list_boss**("map_seed", "1", "不重复", "不放回")"<br />) |
| 战利品来源 | award_source  | 对战胜利后的战利品来源 | group_award(<br />"3", <br />"group_award_common ( <br />"list_unit_common ( " map_seed " , " 2 " , " 重复 " , " 放回 " ) " , <br />"list_artifact_common ( " map_seed " , " 1 " , " 不重复 " , " 不放回 " ) " ) " ,<br />"group_award_boss ( <br />"list_unit_SR ( " map_seed " , " 1 " , " 重复 " , " 放回 " ) " , <br />"list_artifact_boss ( " map_seed " , " 1 " , " 不重复 " , " 不放回 " ) " ) |

注：

（1）

|        方法        |                            参数1                             |                   参数2                    |                 参数3                  |
| :----------------: | :----------------------------------------------------------: | :----------------------------------------: | :------------------------------------: |
|    group_battle    |       强度系数（战斗怪物等级=强度系数×关卡数×回合数）        |       list_monster【存放小怪的list】       |    list_boss【存放boss怪物的list】     |
|    group_award     | 使用回合数round_id对此参数取模，非0时使用参数2，0时使用参数3 | group_award_common【存放普通战斗的战利品】 | group_award_boss【存放boss战的战利品】 |
| group_award_common |                       list_unit_common                       |            list_artifact_normal            |                   -                    |
|  group_award_boss  |                        list_unit_ssr                         |             list_artifact_boss             |                   -                    |

（1）list_monster= (list_monster_01, list_monster_02....)

（2）list_boss= (所有包含 单位.类型 == "boss")

（3）list_unit_common = （所有包含 单位.等级 != "SSR" && 单位.类型 == "attendant" || 所有包含 单位.等级 != "SSR" && 单位.类型 == "equipment" ）

（4）list_artifact_normal = (所有包含 神器.等级 = "N")

（5）list_unit_ssr= （所有包含 单位.等级 == "ssr" && 单位.类型 == "attendant" || 所有包含 单位.等级 == "SSR" && 单位.类型 == "equipment" ）

（6）list_artifact_boss = (所有包含 神器.等级 = "boss")



![image-20210322183229464](https://i.loli.net/2021/03/22/rhbANKUMo5aB1uY.png)



### 2.2.9 事件卡参数<div id="229">

（1）事件模型被选中时，希望能像在Unity中选中模型文件一样，底座和事件模型周围都有一圈同色的线条，表示选中状态，然后在屏幕的下部查看详情

![image-20210520195746379](https://i.loli.net/2021/05/20/RhWoUr8gmwa54Ev.png)

（2）事件在被使用或者能量点归零之后，底座连带事件模型都一起消失，目前先省略中间的消失破碎的过程动画，直接缺一块

![image-20210520200232198](https://i.loli.net/2021/05/20/slj3KEDXr9v6GtT.png)

（3）事件的共同参数

|      字段名      |           字段            |                         值说明                         |          值示例           |
| :--------------: | :-----------------------: | :----------------------------------------------------: | :-----------------------: |
|     事件标题     |       MapCard_title       |               显示在画面下方的事件详情中               |         招募单位          |
|     事件说明     |   MapCard_introduction    |                     描述事件的说明                     |             -             |
| 事件能量点最大值 |         max_point         |                 能量点随机范围的最大值                 |             3             |
| 事件能量点最小值 |         min_point         |                 能量点随机范围的最小值                 |             2             |
|    能量点效果    |       point_effect        |     事件卡被能量点击中后的额外效果，从效果池中随机     | [<div>效果池</div>](#xgc) |
|  能量点效果说明  | point_effect_introduction | 读取能量点效果的文字说明，并显示在画面下方的事件详情中 |   事件能量点不会小于1点   |
|   事件主体模型   |    MapCard_main_model     |          事件的主体模型，不同类的主体模型不同          |          预制体           |



<! -- 2.2.10 获取单位事件<div id="2210">

|      字段名      |           字段            |                         值说明                         |         值示例         |
| :--------------: | :-----------------------: | :----------------------------------------------------: | :--------------------: |
|     事件标题     |       MapCard_title       |               显示在画面下方的事件详情中               |        招募单位        |
|     事件说明     |   MapCard_introduction    |       描述事件的说明。显示在画面下方的事件详情中       | 招募该单位加入你的团队 |
| 事件能量点最大值 |         max_point         |                 能量点随机范围的最大值                 |           3            |
| 事件能量点最小值 |         min_point         |                 能量点随机范围的最小值                 |           2            |
|    能量点效果    |       point_effect        |     事件卡被能量点击中后的额外效果，从效果池中随机     |    random（能量池）    |
|  能量点效果说明  | point_effect_introduction | 读取能量点效果的文字说明，并显示在画面下方的事件详情中 |           -            |
|   事件主体模型   |    MapCard_main_model     |          事件的主体模型，不同类的主体模型不同          |    随机出的单位模型    |

|  参数名  |    参数     |               值说明                |                    值示例                     |
| :------: | :---------: | :---------------------------------: | :-------------------------------------------: |
| 单位来源 | unit_source | 从所给定的单位分组中随机选择1个单位 | list_unit_common（map_seed, 1, 不重复, 放回） |

（1）list_unit_common = （所有包含 单位.等级 != "SSR" && 单位.类型 == "attendant" || 所有包含 单位.等级 != "SSR" && 单位.类型 == "equipment"）

### 2.2.11 营地事件<div id="2211">

|      字段名      |           字段            |                         值说明                         |              值示例              |
| :--------------: | :-----------------------: | :----------------------------------------------------: | :------------------------------: |
|     事件标题     |       MapCard_title       |               显示在画面下方的事件详情中               |             休憩营地             |
|     事件说明     |   MapCard_introduction    |       描述事件的说明，显示在画面下方的事件详情中       | 升级团队中的单位或者回复英雄生命 |
| 事件能量点最大值 |         max_point         |                 能量点随机范围的最大值                 |                3                 |
| 事件能量点最小值 |         min_point         |                 能量点随机范围的最小值                 |                2                 |
|    能量点效果    |       point_effect        |     事件卡被能量点击中后的额外效果，从效果池中随机     |         random（能量池）         |
|  能量点效果说明  | point_effect_introduction | 读取能量点效果的文字说明，并显示在画面下方的事件详情中 |                -                 |
|   事件主体模型   |    MapCard_main_model     |          事件的主体模型，不同类的主体模型不同          |           营地专属模型           |

|         字段名          |       字段       |                    值说明                     | 值示例 |
| :---------------------: | :--------------: | :-------------------------------------------: | :----: |
|       单次升级数        |   once_update    |            目标单位单次提升多少级             |   1    |
|      初始生命回复       | initial_recovery |              无加成下的生命恢复               |   10   |
| 每1能量点减少增生命回复 | appendl_recovery | 卡牌能量点每减少1点，可恢复生命值便增加相应值 |   3    |



![image-20210322152558611](https://i.loli.net/2021/03/22/doIGB9ykx7sSMTa.png)



### 2.2.12 秘宝事件<div id="2212">

|      字段名      |           字段            |                         值说明                         |        值示例        |
| :--------------: | :-----------------------: | :----------------------------------------------------: | :------------------: |
|     事件标题     |       MapCard_title       |               显示在画面下方的事件详情中               |        大秘宝        |
|     事件说明     |   MapCard_introduction    |       描述事件的说明，显示在画面下方的事件详情中       | 从三个神器中选择一个 |
| 事件能量点最大值 |         max_point         |                 能量点随机范围的最大值                 |          3           |
| 事件能量点最小值 |         min_point         |                 能量点随机范围的最小值                 |          2           |
|    能量点效果    |       point_effect        |     事件卡被能量点击中后的额外效果，从效果池中随机     |         共生         |
|  能量点效果说明  | point_effect_introduction | 读取能量点效果的文字说明，并显示在画面下方的事件详情中 |          -           |
|   事件主体模型   |    MapCard_main_model     |          事件的主体模型，不同类的主体模型不同          |     秘宝专属模型     |

|  字段名  |      字段       | 值说明 |                      值示例                       |
| :------: | :-------------: | :----: | :-----------------------------------------------: |
| 神器来源 | artifact_source |   -    | list_artifact_normal(map_seed, 3, 不重复，不放回) |

![image-20210413170919591](https://i.loli.net/2021/04/13/7ivBL8d5axby2ES.png)

注：

（1）list_artifact_normal= 所有包含 神器.等级 = "N"

### 2.2.13 单位强化<div id="2213">

|      字段名      |           字段            |                         值说明                         |                 值示例                 |
| :--------------: | :-----------------------: | :----------------------------------------------------: | :------------------------------------: |
|     事件标题     |       MapCard_title       |               显示在画面下方的事件详情中               |                单位强化                |
|     事件说明     |   MapCard_introduction    |       描述事件的说明，显示在画面下方的事件详情中       | 选择一个效果来强化你的英雄、随从或装备 |
| 事件能量点最大值 |         max_point         |                 能量点随机范围的最大值                 |                   3                    |
| 事件能量点最小值 |         min_point         |                 能量点随机范围的最小值                 |                   2                    |
|    能量点效果    |       point_effect        |     事件卡被能量点击中后的额外效果，从效果池中随机     |                  共生                  |
|  能量点效果说明  | point_effect_introduction | 读取能量点效果的文字说明，并显示在画面下方的事件详情中 |                   -                    |
|   事件主体模型   |    MapCard_main_model     |          事件的主体模型，不同类的主体模型不同          |              强化专属模型              |

|  字段名  |      字段      |                值说明                |                 值示例                 |
| :------: | :------------: | :----------------------------------: | :------------------------------------: |
| 效果来源 | effect_source  | 根据数量从效果来源中不重复的随机抽取 | list_effect(map_seed, 1, 不重复, 放回) |
| 强化等级 | strength_level |      用于定义强化属性的数值强度      |                   3                    |

注：

（1）list_effect内的效果来自[<div>效果池</div>](#221)

![image-20210427170909257](https://i.loli.net/2021/04/27/dF54vmWPIVxXg9O.png)

（1）选择完强化效果后，调用通用的单位选择模板，并将各个强化效果所禁用的类型带入单位选择模板中

（2）除了强化效果自带的禁用类型以外，已经获得两个强化效果的单位也将被禁用



### 2.2.14 许愿事件<div id="2214">

![image-20210427190708767](https://i.loli.net/2021/04/27/Qe5stw891jaJfHp.png)

|      字段名      |           字段            |                         值说明                         |                         值示例                         |
| :--------------: | :-----------------------: | :----------------------------------------------------: | :----------------------------------------------------: |
|     事件标题     |       MapCard_title       |               显示在画面下方的事件详情中               |                          许愿                          |
|     事件说明     |   MapCard_introduction    |       描述事件的说明，显示在画面下方的事件详情中       | 选择一个随从职业或者装备，你将获得一个随机稀有度的单位 |
| 事件能量点最大值 |         max_point         |                 能量点随机范围的最大值                 |                           3                            |
| 事件能量点最小值 |         min_point         |                 能量点随机范围的最小值                 |                           2                            |
|    能量点效果    |       point_effect        |     事件卡被能量点击中后的额外效果，从效果池中随机     |                          共生                          |
|  能量点效果说明  | point_effect_introduction | 读取能量点效果的文字说明，并显示在画面下方的事件详情中 |                           -                            |
|   事件主体模型   |    MapCard_main_model     |          事件的主体模型，不同类的主体模型不同          |                      许愿专属模型                      |

|    字段名    |       字段       |                   值示例                   |
| :----------: | :--------------: | :----------------------------------------: |
| 战士随从来源 |  warrior_source  |  list_warrior(init_seed, 1, 不重复, 放回)  |
| 盗贼随从来源 |   rogue_source   |   list_rogue(init_seed, 1, 不重复, 放回)   |
| 法师随从来源 |   mage_source    |   list_mage(init_seed, 1, 不重复, 放回)    |
| 猎人随从来源 |  hunter_source   |  list_hunter(init_seed, 1, 不重复, 放回)   |
| 牧师随从来源 |  priest_source   |  list_priest(init_seed, 1, 不重复, 放回)   |
|   装备来源   | equipment_source | list_equipment(init_seed, 1, 不重复, 放回) |

注：

1. list_warrior(map_seed, 1, 不重复, 放回) = 所有包含 单位.类型 = "attendant" && 单位.职业 = "warrior"
2. rogue_source(map_seed, 1, 不重复, 放回) = 所有包含 单位.类型 = "attendant" && 单位.职业 = "rogue"
3. mage_source(map_seed, 1, 不重复, 放回) = 所有包含 单位.类型 = "attendant" && 单位.职业 = "mage"
4. hunter_source(map_seed, 1, 不重复, 放回) = 所有包含 单位.类型 = "attendant" && 单位.职业 = "hunter"
5. priest_source(map_seed, 1, 不重复, 放回) = 所有包含 单位.类型 = "attendant" && 单位.职业 = "priest"
6. equipment_source(map_seed, 1, 不重复, 放回) = 所有包含 单位.类型 = "attendant" && 单位.职业 = "equipment"

### 2.2.20 能量点效果池<div id="2220">

| 效果名 |                             效果                             | 随机概率 |
| :----: | :----------------------------------------------------------: | :------: |
|  常规  |             被能量点击中时，自身的能量点减少1点              |   40%    |
|  爆炸  |    被任意能量点击中后，事件立刻消失，并释放所有事件能量点    |   10%    |
|  坚韧  |                    事件能量点不会小于1点                     |   10%    |
|  连锁  |            每被击中1次，所有事件的现有能量点数减1            |   10%    |
|  聚合  |         被能量点击中时，自身的能量点不是减少而是增加         |   10%    |
|  共生  | 共生效果的事件被选中时，逸散的能量点优先攻击在场的其他共生事件 |    -     |
|  加倍  |           被选中时逸散的能量点是此时能量点数的2倍            |   10%    |

- 现阶段的能量点就直接在事件模型的旁边显示一个数字
- 理想状态，类似魔兽的法球上显示数字，漂浮在模型旁边

### 2.2.2 地图规则<div id="222">

##### 规则

（1）开场时，系统将从玩家已解锁的所有英雄中随机选取3个英雄，交由玩家3选1。随机分配给玩家3个N级随从或武器，从中选取一个作为初始随从。

（2）在地图上可以配置战场。战场一共有六个卡槽，当单位卡被放置到卡槽后，只能移动在战场内的位置。

（3）当六个槽位都放满单位后，无法再放入或直接更换新的单位，如需更换单位，需要先从战场上选择一个单位放逐，然后再从额外卡牌集合中挑选一个单位置入战场，被放逐的卡牌将从本局游戏中消失,获得放逐补偿，根据放逐的卡牌稀有度来执行相应等级的放逐补偿

（4）当一张地图上的事件卡被确定使用时，根据卡牌的事件能量点数将会有等量的能量点随机飞向其他事件卡，事件卡每被击中1点，其事件能量点便下降1点，当事件能量点为0时，该事件卡从地图上消失。空缺的部分不会有新的事件卡进行补充。

（5）人物等级每打完一关升1级，怪物等级普遍在N至N+2之间浮动，N为回合数。

（6）每关的第三轮为BOSS战，胜利后会随机获得一个BOSS神器

（7）根据初始选择页面选择的英雄，将对应的英雄头像、英雄生命值、英雄等级在地图页面上显示，并将初始选择页面中的随从或武器置入背包中，使其在打开背包时可以被查看

（8）全局游戏一共3个大关，每个大关3轮，每次英雄升级的时候可以获得1次获得新被动技能或升级主被动技能的机会，每次给出两个选项，从【获得新被动技能】【升级主动技能】【升级被动技能】中随机挑选，选项中需要直接给出具体的技能，已满级的技能不会出现在此。

![image-20210517112559681](https://i.loli.net/2021/05/17/ct1Oq7lAU2WLrze.png)

（9）获得新的单位时，将此时英雄等级赋予给新单位。



### 2.2.3 初始选择<div id="223">

![](https://i.loli.net/2021/05/17/ZdE4xaYcbHpjPK7.png)

（1）该页面为UI，在第一次进入地图的时候会弹出，并在点击【开始】按键后消失

（2）所有选项默认选择第一个

（3）选择完初始卡牌后，马上进行的是第一次技能选择

|  字段名  |      字段       |          值说明           |                        值示例                         |
| :------: | :-------------: | :-----------------------: | :---------------------------------------------------: |
| 英雄来源 |   hero_source   | 从给定的分组中随机挑选3个 |    list_hero_unlock（init_seed, 3, 不重复, 放回）     |
| 单位来源 |   unit_source   | 从给定的分组中随机挑选3个 |    list_unit_normal（init_seed, 3, 不重复, 放回）     |
| 神器来源 | artifact_source | 从给定的分组中随机挑选3个 | list_artifact_normal（init_seed, 3, 不重复,  不放回） |

注意：

（1）list_hero_unlock = (所有包含 单位.类型 = "hero" && 单位.状态 = "unlock")

（2）list_unit_common = （所有包含 单位.等级 != "SSR" && 单位.类型 == "attendant" || 所有包含 单位.等级 != "SSR" && 单位.类型 == "equipment" ）

（3）list_artifact_normal= (所有包含 神器.等级 = "N")

](https://imgtu.com/i/2buYBn)

| 序号 |                            内容                             |
| :--: | :---------------------------------------------------------: |
|  1   |   根据 reward_count_select 和 event_source来展示卡牌个数    |
|  2   |              此处显示奖励说说明 reward_details              |
|  3   | 当所选的卡牌数量不满足reward_count_selected时，按键无法点击 |



### 2.2.3 系统相关奖励卡<div id="223">

##### （1）征召英雄：战士

|   字段   |                 值                 |
| :------: | :--------------------------------: |
| 事件编号 |             reward_01              |
|  事件名  |           征召英雄：战士           |
| 事件说明 | 从所展示的2个单位中挑选1个加入手牌 |
| 事件立绘 |                 -                  |
| 选中个数 |                 1                  |
| 待选个数 |                 2                  |
| 卡牌来源 |   2.1.2 单位分组 / list_warrior    |

##### （2）征召英雄：魔法输出

|   字段   |                 值                 |
| :------: | :--------------------------------: |
| 事件编号 |             reward_02              |
|  事件名  |         征召英雄：魔法输出         |
| 事件说明 | 从所展示的3个单位中挑选1个加入手牌 |
| 事件立绘 |                 -                  |
| 选中个数 |                 1                  |
| 待选个数 |                 2                  |
| 卡牌来源 |     2.1.2 单位分组 / list_mage     |

##### （3）征召英雄：物理输出

|   字段   |                 值                 |
| :------: | :--------------------------------: |
| 事件编号 |             reward_03              |
|  事件名  |         征召英雄：物理输出         |
| 事件说明 | 从所展示的2个单位中挑选1个加入手牌 |
| 事件立绘 |                 -                  |
| 选中个数 |                 1                  |
| 待选个数 |                 2                  |
| 卡牌来源 |   2.1.2 单位分组 / list_physical   |

##### （4）祈愿：神器

|   字段   |                 值                 |
| :------: | :--------------------------------: |
| 事件编号 |             reward_04              |
|  事件名  |             祈愿：神器             |
| 事件说明 | 从3个所展示的神器中挑选1个加入手牌 |
| 事件立绘 |                 -                  |
| 选中个数 |                 1                  |
| 待选个数 |                 3                  |
| 卡牌来源 |      2.3神器 / list_artifact       |

##### （5）激活：血脉强化

|        字段名         |                      值                       |
| :-------------------: | :-------------------------------------------: |
|       事件编号        |                   reward_06                   |
|        事件名         |                激活：血脉强化                 |
|       事件说明        |     从3个所展示的强化效果挑选1个进行激活      |
|       事件立绘        |                       -                       |
|       选中个数        |                       1                       |
|       待选个数        |                       3                       |
| 卡牌来源1（根据英雄） | 2.4 强化 / list_strengthen_Exclusive_unit_001 |
| 卡牌来源2（根据英雄） | 2.4 强化 / list_strengthen_Exclusive_unit_002 |
| 卡牌来源3（根据英雄） | 2.4 强化 / list_strengthen_Exclusive_unit_003 |

注：

（1）血脉强化事件卡的强化卡展示时，需要根据已选择的3位英雄从对应专属的强化list种挑选1种展示，每个英雄对应1张卡位

（2）在战备阶段打出强化奖励卡时，原本属于该英雄的强化位上将被替换成获得该英雄卡，直到某一战备阶段选择该选项后，将该英雄卡置入手牌。



### 
